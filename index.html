<!doctype html>

<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WorkerHire — Demo</title>
  <style>
    :root{--accent:#2563eb;--muted:#6b7280;--card:#fff;--bg:#f6f7fb}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0;background:var(--bg);color:#111}
    .container{max-width:920px;margin:20px auto;padding:16px}
    .card{background:var(--card);border-radius:12px;padding:18px;margin-bottom:18px;box-shadow:0 6px 20px rgba(16,24,40,0.06)}
    h1,h2,h3{margin:0 0 8px}
    label{display:block;font-weight:600;margin-bottom:6px;color:#333}
    input,select,textarea,button{width:100%;padding:10px;border-radius:8px;border:1px solid #e7e7e7}
    .row{display:flex;gap:12px}
    .col{flex:1}
    button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
    button.secondary{background:#10b981}
    .muted{color:var(--muted);font-size:14px}
    .worker-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    .worker{padding:12px;border-radius:10px;border:1px solid #eef3ff;background:#fff}
    .profile{width:100%;height:140px;object-fit:cover;border-radius:8px;margin-bottom:8px}
    .actions{display:flex;gap:8px}
    select#selectWorker{height:44px}
    .notice{color:var(--muted);font-size:13px;margin-top:8px}
    footer{text-align:center;padding:20px;color:var(--muted)}
    @media (max-width:520px){.profile{height:120px}}
  </style>
</head>
<body>
  <div class="container">
    <header class="card">
      <h1>WorkerHire — Demo</h1>
      <div class="muted">Local demo — फोटो और डाटा browser localStorage में सेव होंगे</div>
    </header><div class="card">
  <h3>Available Workers</h3>
  <div id="workers" class="worker-list">
    <!-- js will render -->
  </div>
  <div class="muted" style="margin-top:8px">Add sample worker या अपना प्रोफ़ाइल बनायें।</div>
</div>

<div class="card">
  <h3>Add Worker (Demo) <label style="display:inline;font-weight:400">Photo (optional)</label></h3>
  <input id="wphoto" type="file" accept="image/*" />

  <div style="margin-bottom:8px;margin-top:8px">
    <label>Name</label>
    <input id="wname" placeholder="Ram, Suresh..." />
  </div>

  <div class="row" style="margin-bottom:8px">
    <div class="col">
      <label>Category</label>
      <select id="wcat">
        <option>Plumber</option>
        <option>Carpenter</option>
        <option>Housemaid</option>
        <option>Electrician</option>
      </select>
    </div>
    <div class="col">
      <label>Rate per hour (₹)</label>
      <input id="wrate" placeholder="e.g. 200" type="number" />
    </div>
  </div>

  <label>Short description</label>
  <textarea id="wdesc" rows="2" placeholder="Experience and skills..."></textarea>

  <div style="margin-top:10px;display:flex;gap:8px">
    <button id="addWorker">Add Worker</button>
    <button id="loadSample" class="secondary" style="width:auto;padding:10px 14px">Load sample</button>
  </div>
</div>

<div class="card">
  <h3>Book a Worker (Quick)</h3>
  <div style="margin-bottom:10px">
    <label>Select Worker</label>
    <select id="selectWorker"></select>
  </div>
  <div style="margin-bottom:10px">
    <label>Hours</label>
    <input id="hours" type="number" value="1" min="1" />
  </div>
  <div style="display:flex;gap:8px;align-items:center">
    <button id="bookBtn">Book & Pay</button>
    <div id="status" class="muted" style="margin-left:8px"></div>
  </div>

  <div class="muted" style="margin-top:8px">
    <ol>
      <li>Click a worker, set hours and press <b>Book & Pay</b>.</li>
      <li>Razorpay checkout will open (if backend configured).</li>
      <li>Platform takes commission (10%) — backend calculates it.</li>
    </ol>
  </div>
</div>

<footer class="card">WorkerHire • Demo • Built for you</footer>

  </div>  <script>
    // --- CONFIG: edit these if you have a backend or Razorpay key ---
    // If you don't have backend just leave BACKEND_URL = null and booking will be demo-only
    const BACKEND_URL = null; // e.g. 'https://your-server.example.com'
    const RAZORPAY_KEY_ID = null; // e.g. 'rzp_test_xxx' — used only if backend supports creating orders

    // --- helpers ---
    function saveWorkers(list){
      localStorage.setItem('workers_v1', JSON.stringify(list));
      renderWorkers();
    }

    function loadWorkers(){
      try{return JSON.parse(localStorage.getItem('workers_v1'))||[];}catch(e){return[]}
    }

    function readFileAsDataURL(file){
      return new Promise((resolve,reject)=>{
        if(!file) return resolve(null);
        const fr = new FileReader();
        fr.onload = ()=> resolve(fr.result);
        fr.onerror = ()=> reject(new Error('File read error'));
        fr.readAsDataURL(file);
      });
    }

    // render list & select
    function renderWorkers(){
      const container = document.getElementById('workers');
      const select = document.getElementById('selectWorker');
      const list = loadWorkers();
      container.innerHTML = '';
      select.innerHTML = '<option value="">Choose a worker</option>';

      list.forEach((w,i)=>{
        const el = document.createElement('div'); el.className='worker';
        const photoHtml = w.photo ? `<img src="${w.photo}" class="profile" alt="${w.name}"/>` : '';
        el.innerHTML = `
          ${photoHtml}
          <strong>${w.name}</strong>
          <div class="muted">${w.cat} • ₹${w.rate}/hr</div>
          <div style="margin-top:8px">${w.desc || ''}</div>
          <div class="actions" style="margin-top:8px">
            <button data-i="${i}" style="flex:1">Select</button>
          </div>
        `;
        container.appendChild(el);

        // add to select
        const opt = document.createElement('option'); opt.value = i; opt.text = `${w.name} — ${w.cat} — ₹${w.rate}/hr`;
        select.appendChild(opt);
      });

      // attach select buttons
      container.querySelectorAll('button[data-i]').forEach(btn=>{
        btn.onclick = (e)=>{
          const idx = e.currentTarget.getAttribute('data-i');
          document.getElementById('selectWorker').value = idx;
          window.scrollTo({top:0,behavior:'smooth'});
        }
      });
    }

    // add worker handler
    async function addWorkerHandler(){
      try{
        const name = (document.getElementById('wname').value||'').trim();
        const cat = (document.getElementById('wcat').value||'').trim();
        const rate = (document.getElementById('wrate').value||'').trim();
        const desc = (document.getElementById('wdesc').value||'').trim();
        const photoInput = document.getElementById('wphoto');

        if(!name || !rate){ alert('Name और Rate डालना ज़रूरी है'); return; }

        let photoData = null;
        if(photoInput && photoInput.files && photoInput.files[0]){
          try{ photoData = await readFileAsDataURL(photoInput.files[0]); }catch(e){ console.warn('Photo read failed', e); photoData = null; }
        }

        const list = loadWorkers();
        list.push({name, cat:cat||'Other', rate: Number(rate)||rate, desc, photo: photoData});
        saveWorkers(list);

        alert('Worker added successfully');
        // clear form
        document.getElementById('wname').value='';
        document.getElementById('wrate').value='';
        document.getElementById('wdesc').value='';
        if(photoInput) photoInput.value='';

        window.scrollTo({top:0,behavior:'smooth'});
      }catch(err){ console.error('Add worker error', err); alert('कुछ गलती हुई — console में देखें'); }
    }

    // attach add button (safe if DOM not ready)
    function attachAddWorker(){
      const btn = document.getElementById('addWorker');
      if(btn) btn.onclick = addWorkerHandler;
      else setTimeout(attachAddWorker,300);
    }

    // load sample workers
    function loadSample(){
      const sample = [
        {name:'Ram',cat:'Plumber',rate:200,desc:'5 years experience',photo:null},
        {name:'Suresh',cat:'Carpenter',rate:250,desc:'Good at furniture',photo:null}
      ];
      saveWorkers(sample);
      alert('Sample data loaded');
    }

    // booking (demo) — if BACKEND_URL is set, you can implement real flow
    async function bookHandler(){
      const idx = document.getElementById('selectWorker').value;
      const hours = Number(document.getElementById('hours').value||1);
      const status = document.getElementById('status');
      if(idx === ''){ alert('Worker select करें'); return; }
      const w = loadWorkers()[idx];
      if(!w){ alert('Worker नहीं मिला'); return; }

      const amount = (Number(w.rate)||0) * hours * 100; // paisa
      status.textContent = 'Processing...';

      if(BACKEND_URL && RAZORPAY_KEY_ID){
        // here you'd call your backend to create an order then open Razorpay checkout
        status.textContent = 'Backend configured — payment flow not implemented in demo';
        // NOTE: You need a backend to create orders securely. Leave as demo if you have no server.
      } else {
        // demo-only: simulate success
        setTimeout(()=>{
          status.textContent = '';
          alert(`Demo booking success. ${w.name} booked for ${hours} hour(s). Amount: ₹${(amount/100).toFixed(2)}`);
        },600);
      }
    }

    // attach book handler
    function attachBook(){
      const b = document.getElementById('bookBtn');
      if(b) b.onclick = bookHandler;
      else setTimeout(attachBook,300);
    }

    // initial setup
    function init(){
      attachAddWorker();
      attachBook();
      document.getElementById('loadSample').onclick = loadSample;
      renderWorkers();
    }

    // run on load
    window.addEventListener('DOMContentLoaded', init);
  </script></body>
</html>
